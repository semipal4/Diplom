## Инструкция по установке и настройке конфигурации для работы с подсистемой «Обслуживание клиентов»

#### 1.Установие конфигурацию на вашу базу данных.
### 2. Для работы с объектами подсистемой «Обслуживание клиентов» в конфигурации созданы профили, поставляемые вместе с конфигурацией.
У пользователей в правах доступа укажите соответствующие профили
Профиль **ВКМ – Специалист**

|Документы	| Обслуживание клиента» |	Полные права|
|-----------|-----------|-----------|
|Справочники	|Контрагенты», «Договоры| 	Чтение|
|Справочники	|Уведомления телеграмм-боту |	Полные права|
|Регистр	|Выполненные клиентом работы, Выполненные сотрудником работы |	Полные права|
|Обработки	|Календарь специалистов |	Полные права|

Профиль **ВКМ – Менеджер**
|	Документы	|	Обслуживание клиента, Реализация товаров и услуг	|	Полные права	|
|-----------|-----------|-----------|
|	Справочники	|	Контрагенты, Договоры, Уведомления телеграмм-боту	|	Полные права	|
|	Регистр	|	Выполненные клиентом работы, «Выполненные сотрудником работы	|	Полные права	|
|	Обработки	|	Календарь специалистов»	|	Полные права	|
|	Константы	|	Токен управления телеграмм-ботом, Идентификатор группы для оповещения	|	Полные права	|
|	Константы	|	ВКМ_НоменклатураАбонентскаяПлата, ВКМ_НоменклатураРаботыСпециалиста	|	Чтение	|

Профиль **ВКМ - Бухгалтер ИТ Фирмы**
|-----------|-----------|-----------|
|	Документы	|	Реализация товаров и услуг	|	Полные права	|
|	Справочники	|	Контрагенты», Договоры	|	Чтение	|
|	Регистр	|	Выполненные клиентом работы, ОстаткиТоваров	|	Полные права	|
|	Обработки	|	Массовое создание актов	|	Полные права	|
|	Константы	|	ВКМ_НоменклатураАбонентскаяПлата, ВКМ_НоменклатураРаботыСпециалиста	|	Полные права	|

Профиль **ВКМ - Кадровик расчетчик**
|	Документы	|	Начисление заработной платы, Начисление фиксированных премий, График отпусков, Выплата зарплаты	|	Полные права	|
|-----------|-----------|-----------|
|	Справочники	|	Организации, Пользователи, Номенклатура	|	Чтение	|
|	Регистр	|	Данные графика, Условия оплаты сотрудников, Отпуска сотрудников, Выполненные сотрудником работы, Взаиморасчеты с сотрудниками	|	Полные права	|
|	Обработки	|	Календарь специалистов, Заполнение графика	|	Полные права	|

### 2. Для работы с конфигурацией необходимо заполнить четыре константы:

1. Константы  *«Номенклатура абонентская плата (ВКМ)», «Номенклатура работы специалиста (ВКМ)»*. Данные константы заполняются значениями из справочника **Номенкатура**. Первый элемент  справочника **Номенклатура** д.б. ***«Абонентская плата»***, второй – ***«Работы специалиста»***.

2. Константы *«Токен управления телеграм-ботом (ВКМ)», «Идентификатор группы для оповещения (ВКМ)»* для  взаимодействия с **Телеграмм**.

Оповещение специалистов о появлении новой заявки происходит через *телеграм-бот*.

После сохранения и/или проведения  документа *«Обслуживание клиента»* автоматически формируется сообщение для *Telegramm* (через элемент справочника *«Уведомления телеграмм-боту»*). Сообщения сохраняются в справочнике до момента их успешной отправки в Telegamm (код ответа 200). В случае внесения изменений в документ *«Обслуживание клиента»* таких как, клиент, дата и время, формируется повторное сообщение для Telegramm с измененными данными.

Для заполнения констант ***«Токен управления телеграмм-ботом»*** и ***«Идентификатор группы для оповещения»*** обратитесь к вашим техническими специалистам.

***Информация для тех. специалиста:*** 

*Создание бота (токена): 1. Напишете в Телеграм https://t.me/BotFather команду "/start" 2. Напишите команду "/newbot" 3. Выберите имя вашего бота, которое будут видеть пользователи 4. Выберите идентификатор вашего бота (он должен заканчиваться на "bot") 5. Скопируйте токен, который пришлет BotFather и сохраните его в константу «Токен управления телеграмм-ботом».*

*Создание группы: 1. Создайте группу в Телеграм 2. Добавьте в группу только что созданного бота 3. Назначьте боту права администратора. 4. Напишите любое сообщение в группу 5. С помощью браузера или Postman выполните запрос https://api.telegram.org/botВашТокен/getUpdates . В полученном JSON найдите идентификатор группы, в которой получено сообщение, и сохраните его в константу «Идентификатор группы для оповещения».*

*Регламентное задание «ВКМ_РегламентноеЗаданиеОтравитьВсеСообщенияВГруппуТелеграмм» обходить элементы справочника «Уведомления телеграм-боту», отправлять и после успешной отправки удалять элементы справочника.*


*При записи документа «Обслуживание клиента», если документ записывается первый раз или если дата, время или специалист изменились, в справочник добавляется сообщение с текстом, описывающим изменения (реализовано в методе ПередЗаписью() документа «Обслуживание клиента»).*

### 3. Использование календаря специалистов

Для отображения запланированных работ и свободных слотов для новых вызовов можно воспользоваться календарем-планировщиком (доступ с домашней страницы программы или через запуск обработки **«Календарь специалистов»**). 

Создание нового документа «Обслуживание клиента» возможно через активизацию одной или выделения ряда ячеек в календаре. 

***Данный календарь доступен для профилей Специалист и Менеджер***

*Период, в котором отображаются запланированные вызовы к клиентам, определяется программно в модуле формы обработки «ВКМ_КалендарьСпециалистов», метод ОбновитьПланировщик()*

*НачалоПриода = НачалоНедели(ТекущаяДатаСеанса());*

*КонецПериода = КонецМесяца(ТекущаяДатаСеанса());*

### 4. Дополнительные настройки  для работы с подсистемой «Обслуживание клиентов»

Специалист вносит в информационную систему информацию о выполненных работах, количество фактически потраченных часов на каждый вид работы, количество часов к оплате клиенту за каждый вид работы и прикрепляет к документу скан/фото листа учёта рабочего времени.

Для  проведения документа **«Обслуживание клиентов»** по регистрам учета необходимо предварительно  настроить регистры:

1. Регистр сведений *«Условия оплаты сотрудников (ВКМ)»*, в котором для пользователей с профилем *«Специалист»* нужно указать оклад и процент от суммы выполненных работ.

2. Для проведения документа *«Обслуживание клиента»* по регистру *«Выполненные клиенту работы»* необходимо в договорах типа  *«Абонентское обслуживание»* проставить стоимость часа выполняемых  у клиента работ.

